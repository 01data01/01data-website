<div class="monthly-view">
    <h4 class="text-center mb-4">{{ current_date.strftime('%B %Y') }}</h4>
    <div class="grid grid-cols-7 gap-1">
        <!-- Calendar Header -->
        <div class="text-center font-medium p-2">Mon</div>
        <div class="text-center font-medium p-2">Tue</div>
        <div class="text-center font-medium p-2">Wed</div>
        <div class="text-center font-medium p-2">Thu</div>
        <div class="text-center font-medium p-2">Fri</div>
        <div class="text-center font-medium p-2">Sat</div>
        <div class="text-center font-medium p-2">Sun</div>

        <!-- Calendar Days -->
        {% for week in calendar %}
            {% for day in week %}
                <div class="border min-h-[100px] p-2 {% if day != 0 %}{% if day == current_date.day %}bg-blue-50{% else %}bg-white{% endif %}{% else %}bg-gray-50{% endif %}">
                    {% if day != 0 %}
                        <div class="font-medium {% if day == current_date.day %}text-blue-600{% endif %}">
                            {{ day }}
                        </div>
                        {% set date_str = '%d-%02d-%02d'|format(current_date.year, current_date.month, day) %}
                        {% if events[date_str] %}
                            <div class="mt-1 space-y-1 overflow-y-auto max-h-[150px]">
                                {% for event in events[date_str] %}
                                    <div class="event-item p-1 rounded text-xs {% if event.priority == 1 %}bg-red-50{% elif event.priority == 2 %}bg-yellow-50{% else %}bg-green-50{% endif %}">
                                        <div class="flex items-start gap-1">
                                            <input type="checkbox" 
                                                   class="form-checkbox h-3 w-3 text-blue-600 mt-0.5"
                                                   {% if event.status == 'done' %}checked{% endif %}
                                                   onchange="updateTaskStatus('{{ event.id }}', this.checked ? 'done' : 'todo')">
                                            <div class="flex-grow">
                                                <div class="font-medium {% if event.status == 'done' %}line-through text-gray-500{% endif %}">
                                                    {% if event.time %}{{ event.time }} - {% endif %}
                                                    {% if event.priority == 1 %}âš¡{% endif %}
                                                    {{ event.description }}
                                                </div>
                                                {% if event.notes %}
                                                <div class="text-gray-600 mt-0.5 line-clamp-1 whitespace-pre-wrap {% if event.status == 'done' %}line-through{% endif %}">
                                                    {{ event.notes }}
                                                </div>
                                                {% endif %}
                                                {% if event.reminders %}
                                                <div class="text-gray-600 mt-0.5 {% if event.status == 'done' %}line-through{% endif %}">
                                                    ðŸ”” {{ event.reminders|length }} reminder{{ 's' if event.reminders|length > 1 }}
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    {% endif %}
                </div>
            {% endfor %}
        {% endfor %}
    </div>
</div>