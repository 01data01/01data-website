<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intelligent Management - 01data</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Modular CSS Imports -->
    <link rel="stylesheet" href="css/modules/base.css">
    <link rel="stylesheet" href="css/modules/auth.css">
    <link rel="stylesheet" href="css/modules/layout.css">
    <link rel="stylesheet" href="css/modules/dashboard.css">
    <link rel="stylesheet" href="css/modules/tasks.css">
    <link rel="stylesheet" href="css/modules/calendar.css">
    <link rel="stylesheet" href="css/modules/ai-chat.css">
    <link rel="stylesheet" href="css/modules/voice-chat.css">
    <link rel="stylesheet" href="css/modules/voice-auth.css">
    <link rel="stylesheet" href="css/modules/components.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzJjNWY1ZCIvPgo8cGF0aCBkPSJNOCAxMkw4IDE2TDEyIDE2TDEyIDEyWiIgZmlsbD0iIzRkYjZhYyIvPgo8cGF0aCBkPSJNMTQgMTBMMTQgMThMMTggMThMMTggMTBaIiBmaWxsPSIjNGRiNmFjIi8+CjxwYXRoIGQ9Ik0yMCA4TDIwIDIwTDI0IDIwTDI0IDhaIiBmaWxsPSIjNGRiNmFjIi8+CjxjaXJjbGUgY3g9IjEwIiBjeT0iOCIgcj0iMSIgZmlsbD0iIzRkYjZhYyIvPgo8Y2lyY2xlIGN4PSIxNiIgY3k9IjYiIHI9IjEiIGZpbGw9IiM0ZGI2YWMiLz4KPGNPCMKY9IngyMiIgY3k9IjQiIHI9IjEiIGZpbGw9IiM0ZGI2YWMiLz4KPHN2Zz4K">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <meta name="google-signin-client_id" content="336524755075-i029li7vjliiekjhheadd7ilr03aj73o.apps.googleusercontent.com">
    
    <!-- Modular JavaScript Imports -->
    <script src="config.js"></script>
    <script src="js/modules/core/utils.js?v=1.1"></script>
    <script src="js/modules/core/auth.js"></script>
    <script src="js/modules/ai/ai-service.js"></script>
    <script src="js/modules/features/dashboard.js"></script>
    <script src="js/modules/features/tasks.js"></script>
    <script src="js/modules/features/calendar.js"></script>
    <script src="js/modules/features/projects.js"></script>
    <script src="js/modules/features/voice-auth.js"></script>
    <script src="js/modules/features/voice-chat.js"></script>
    <script src="js/modules/features/ai-chat.js"></script>
    <script src="js/modules/core/main.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-brain">
                <div class="loading-neural-paths">
                    <div class="loading-neural-line"></div>
                    <div class="loading-neural-line"></div>
                    <div class="loading-neural-line"></div>
                    <div class="loading-neural-line"></div>
                </div>
            </div>
            <h2>Initializing Intelligent Management</h2>
            <p>Setting up your AI-powered workspace...</p>
        </div>
    </div>

    <!-- Google Sign-In Screen -->
    <div id="signInScreen" class="sign-in-screen">
        <div class="sign-in-content">
            <div class="sign-in-header">
                <div class="mgmt-icon">
                    <div class="mgmt-brain">
                        <div class="mgmt-neural-paths">
                            <div class="mgmt-neural-line"></div>
                            <div class="mgmt-neural-line"></div>
                            <div class="mgmt-neural-line"></div>
                            <div class="mgmt-neural-line"></div>
                        </div>
                    </div>
                </div>
                <h1>Intelligent Management</h1>
                <p>Sign in to access your AI-powered workspace</p>
            </div>
            <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark"></div>
            <div id="signInError" class="sign-in-error" style="display: none;"></div>
            
            <!-- Demo Mode Button for Development -->
            <div style="margin-top: 20px; text-align: center;">
                <button onclick="enableDemoMode()" class="btn-secondary" style="font-size: 0.9rem; padding: 8px 16px;">
                    üöÄ Demo Mode (Skip Sign-In)
                </button>
                <p style="font-size: 0.8rem; color: #666; margin-top: 8px;">
                    For testing purposes - bypasses Google Sign-In
                </p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <div class="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </button>
                <div class="logo-container">
                    <div class="mgmt-icon">
                        <div class="mgmt-brain">
                            <div class="mgmt-neural-paths">
                                <div class="mgmt-neural-line"></div>
                                <div class="mgmt-neural-line"></div>
                                <div class="mgmt-neural-line"></div>
                                <div class="mgmt-neural-line"></div>
                            </div>
                        </div>
                    </div>
                    <h1>Intelligent Management</h1>
                </div>
                <nav class="main-nav">
                    <button class="nav-btn active" data-view="dashboard">
                        <span class="nav-icon icon-dashboard"></span>
                        <span class="nav-text">Dashboard</span>
                    </button>
                    <button class="nav-btn" data-view="tasks">
                        <span class="nav-icon icon-tasks"></span>
                        <span class="nav-text">Tasks</span>
                    </button>
                    <button class="nav-btn" data-view="calendar">
                        <span class="nav-icon icon-calendar"></span>
                        <span class="nav-text">Calendar</span>
                    </button>
                    <button class="nav-btn" data-view="projects">
                        <span class="nav-icon icon-projects"></span>
                        <span class="nav-text">Projects</span>
                    </button>
                    <button class="nav-btn" data-view="ai-chat">
                        <span class="nav-icon icon-ai"></span>
                        <span class="nav-text">AI Assistant</span>
                    </button>
                </nav>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <img src="" alt="User Avatar" class="user-avatar">
                    <span class="user-name">Loading...</span>
                </div>
                <button class="btn-icon" id="signOutBtn" title="Sign Out">
                    <span class="icon-signout">‚èª</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <div id="dashboard-view" class="view active">
                <div class="view-header">
                    <h2>Dashboard</h2>
                    <div class="view-actions">
                        <button class="btn-primary" onclick="window.tasksModule?.showAddTaskModal()">
                            + Quick Task
                        </button>
                    </div>
                </div>
                <div id="dashboardContent"></div>
            </div>

            <!-- Tasks View -->
            <div id="tasks-view" class="view">
                <div class="view-header">
                    <h2>Tasks</h2>
                    <div class="view-actions">
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-filter="all">All</button>
                            <button class="filter-btn" data-filter="pending">Pending</button>
                            <button class="filter-btn" data-filter="completed">Completed</button>
                            <button class="filter-btn" data-filter="overdue">Overdue</button>
                        </div>
                        <button class="btn-primary" id="addTaskBtn">+ Add Task</button>
                    </div>
                </div>
                <div id="allTasksList" class="tasks-list"></div>
            </div>

            <!-- Calendar View -->
            <div id="calendar-view" class="view">
                <div class="view-header">
                    <h2>Calendar</h2>
                    <div class="view-actions">
                        <div class="calendar-controls">
                            <button id="prevPeriod" class="btn-secondary">‚Äπ</button>
                            <span id="currentPeriod" class="current-period">Loading...</span>
                            <button id="nextPeriod" class="btn-secondary">‚Ä∫</button>
                            <button id="todayBtn" class="btn-secondary">Today</button>
                        </div>
                        <div class="view-switcher">
                            <button class="view-btn active" data-view="month">Month</button>
                            <button class="view-btn" data-view="week">Week</button>
                            <button class="view-btn" data-view="day">Day</button>
                        </div>
                    </div>
                </div>
                <div id="calendar" class="calendar-container"></div>
            </div>

            <!-- Projects View -->
            <div id="projects-view" class="view">
                <div class="view-header">
                    <h2>Projects</h2>
                    <div class="view-actions">
                        <button class="btn-primary" id="addProjectBtn">+ Add Project</button>
                    </div>
                </div>
                <div id="projectsList" class="projects-container"></div>
            </div>

            <!-- AI Chat View -->
            <div id="ai-chat-view" class="view">
                <div class="chat-layout">
                    <!-- Left Sidebar for Chat History -->
                    <div class="chat-sidebar" id="chatSidebar">
                        <div class="sidebar-header">
                            <button class="new-chat-btn" id="newChatBtn" title="New Chat">
                                <svg class="new-chat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 6h18l-2-2H5L3 6z"/>
                                    <path d="M5 6v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6"/>
                                    <path d="M12 11v6"/>
                                    <path d="M9 14h6"/>
                                </svg>
                                <span>New Chat</span>
                            </button>
                        </div>
                        
                        <div class="sidebar-content">
                            <div class="history-section">
                                <h3 class="history-title">Recent</h3>
                                <div class="history-list" id="historyList">
                                    <div class="empty-history">
                                        <div class="empty-icon">üí≠</div>
                                        <p>No conversations yet</p>
                                        <span>Start chatting to see history</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Chat Area -->
                    <div class="chat-main">
                        <div class="chat-header">
                            <div class="chat-header-left">
                                <h2>Assistant</h2>
                                <div class="chat-status">
                                    <span class="status-indicator online"></span>
                                    Claude AI Ready
                                </div>
                                <div class="voice-status disconnected">Voice Disconnected</div>
                            </div>
                            <div class="chat-header-right">
                                <!-- Agent Selection -->
                                <div class="agent-selection">
                                    <button class="agent-btn active" id="agentSmartBtn" data-agent="primary" title="Smart Agent">
                                        SMART
                                    </button>
                                    <button class="agent-btn" id="agentElaBtn" data-agent="secondary" title="ELA Agent">
                                        ELA
                                    </button>
                                </div>
                                
                                <!-- Voice Controls -->
                                <div class="voice-controls">
                                    <button class="voice-toggle-btn" id="voiceToggleBtn" title="Toggle Voice Mode">
                                        <span class="voice-icon">üé§</span>
                                        <span class="voice-text">Voice Mode</span>
                                    </button>
                                    <div class="voice-activity-indicator" id="voiceActivity">
                                        <div class="voice-activity-bar"></div>
                                        <div class="voice-activity-bar"></div>
                                        <div class="voice-activity-bar"></div>
                                        <div class="voice-activity-bar"></div>
                                        <div class="voice-activity-bar"></div>
                                    </div>
                                </div>
                                
                                <div class="chat-controls">
                                    <button class="chat-control-btn" id="exportChatBtn" title="Export Chat">
                                        <svg class="control-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                            <polyline points="7,10 12,15 17,10"/>
                                            <line x1="12" y1="15" x2="12" y2="3"/>
                                        </svg>
                                    </button>
                                    <button class="chat-control-btn" id="clearChatBtn" title="Clear All Chats">
                                        <svg class="control-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="3,6 5,6 21,6"/>
                                            <path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2v2"/>
                                            <line x1="10" y1="11" x2="10" y2="17"/>
                                            <line x1="14" y1="11" x2="14" y2="17"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chat-messages" id="chatMessages">
                            <div class="message ai-message">
                                <div class="message-avatar">ü§ñ</div>
                                <div class="message-content">
                                    <p>Hello! I'm your AI assistant. I can help you manage tasks, schedule appointments, and organize your projects. Try saying something like:</p>
                                    <ul>
                                        <li>"Schedule a meeting with the team tomorrow at 2pm"</li>
                                        <li>"What do I have planned for next week?"</li>
                                        <li>"Create a project for the new website redesign"</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chat-input-container">
                            <input type="text" id="chatInput" placeholder="Ask me anything about your tasks and projects..." />
                            <button id="sendChatBtn" class="btn-primary">Send</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Notification Container -->
    <div id="notifications" class="notifications-container"></div>

    <script>
        // Google Sign-In Functions
        function onSignIn(googleUser) {
            // Use the new modular authentication system
            if (window.mainApp) {
                window.mainApp.handleSignIn(googleUser);
            } else {
                console.error('Main app not initialized');
            }
        }
        
        function signOut() {
            // Use the new modular authentication system
            if (window.mainApp) {
                window.mainApp.handleSignOut();
            } else {
                // Fallback
                const auth2 = gapi.auth2.getAuthInstance();
                auth2.signOut().then(function () {
                    console.log('User signed out.');
                    localStorage.removeItem('userData');
                    document.getElementById('signInScreen').style.display = 'block';
                    document.getElementById('app').style.display = 'none';
                });
            }
        }
        
        // Demo mode function
        function enableDemoMode() {
            localStorage.setItem('useDemoMode', 'true');
            console.log('Demo mode enabled, reloading...');
            window.location.reload();
        }

        // Initialize the modular system when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing modular JavaScript system...');
            
            // Wait for modules to be available, then initialize
            function initializeApp() {
                if (typeof window.MainApp !== 'undefined') {
                    window.mainApp = new MainApp();
                    console.log('‚úÖ Main app initialized');
                } else {
                    console.log('‚è≥ Waiting for modules to load...');
                    setTimeout(initializeApp, 100);
                }
            }
            
            initializeApp();
        });
    </script>
</body>
</html>